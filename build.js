"format register";!function(t){function e(t){for(var e=[],i=0,r=t.length;r>i;i++)-1==f.call(e,t[i])&&e.push(t[i]);return e}function i(t,i,r,n){if("string"!=typeof t)throw"System.register provided no module name";var s;s="boolean"==typeof r?{declarative:!1,deps:i,execute:n,executingRequire:r}:{declarative:!0,deps:i,declare:r},s.name=t,c[t]||(c[t]=s),s.deps=e(s.deps),s.normalizedDeps=s.deps}function r(t,e){if(e[t.groupIndex]=e[t.groupIndex]||[],-1==f.call(e[t.groupIndex],t)){e[t.groupIndex].push(t);for(var i=0,n=t.normalizedDeps.length;n>i;i++){var s=t.normalizedDeps[i],o=c[s];if(o&&!o.evaluated){var a=t.groupIndex+(o.declarative!=t.declarative);if(void 0===o.groupIndex||o.groupIndex<a){if(void 0!==o.groupIndex&&(e[o.groupIndex].splice(f.call(e[o.groupIndex],o),1),0==e[o.groupIndex].length))throw new TypeError("Mixed dependency cycle detected");o.groupIndex=a}r(o,e)}}}}function n(t){var e=c[t];e.groupIndex=0;var i=[];r(e,i);for(var n=!!e.declarative==i.length%2,s=i.length-1;s>=0;s--){for(var a=i[s],h=0;h<a.length;h++){var d=a[h];n?o(d):u(d)}n=!n}}function s(t){return l[t]||(l[t]={name:t,dependencies:[],exports:{},importers:[]})}function o(e){if(!e.module){var i=e.module=s(e.name),r=e.module.exports,n=e.declare.call(t,function(t,e){i.locked=!0,r[t]=e;for(var n=0,s=i.importers.length;s>n;n++){var o=i.importers[n];if(!o.locked){var a=f.call(o.dependencies,i);o.setters[a](r)}}return i.locked=!1,e});if(i.setters=n.setters,i.execute=n.execute,!i.setters||!i.execute)throw new TypeError("Invalid System.register form for "+e.name);for(var a=0,u=e.normalizedDeps.length;u>a;a++){var h,p=e.normalizedDeps[a],m=c[p],v=l[p];v?h=v.exports:m&&!m.declarative?h={"default":m.module.exports,__useDefault:!0}:m?(o(m),v=m.module,h=v.exports):h=d(p),v&&v.importers?(v.importers.push(i),i.dependencies.push(v)):i.dependencies.push(null),i.setters[a]&&i.setters[a](h)}}}function a(t){var e,i=c[t];if(i)i.declarative?h(t,[]):i.evaluated||u(i),e=i.module.exports;else if(e=d(t),!e)throw new Error("Unable to load dependency "+t+".");return(!i||i.declarative)&&e&&e.__useDefault?e["default"]:e}function u(e){if(!e.module){var i={},r=e.module={exports:i,id:e.name};if(!e.executingRequire)for(var n=0,s=e.normalizedDeps.length;s>n;n++){var o=e.normalizedDeps[n],h=c[o];h&&u(h)}e.evaluated=!0;var d=e.execute.call(t,function(t){for(var i=0,r=e.deps.length;r>i;i++)if(e.deps[i]==t)return a(e.normalizedDeps[i]);throw new TypeError("Module "+t+" not declared as a dependency.")},i,r);d&&(r.exports=d)}}function h(e,i){var r=c[e];if(!r.evaluated&&r.declarative){i.push(e);for(var n=0,s=r.normalizedDeps.length;s>n;n++){var o=r.normalizedDeps[n];-1==f.call(i,o)&&(c[o]?h(o,i):d(o))}r.evaluated||(r.evaluated=!0,r.module.execute.call(t))}}function d(t){if(p[t])return p[t];var e=c[t];if(!e)throw"Module "+t+" not present.";n(t),h(t,[]),c[t]=void 0;var i=e.declarative?e.module.exports:{"default":e.module.exports,__useDefault:!0};return p[t]=i}var c={},f=Array.prototype.indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},l={},p={};return function(e,r){var n;"undefined"!=typeof n&&n.register?(r(n),n["import"](e)):(r(n={register:i,get:d,set:function(t,e){p[t]=e},newModule:function(t){return t},global:t}),n.set("@empty",n.newModule({})),d(e))}}("undefined"!=typeof window?window:global)("lib/main",function(t){t.register("classes/mob",[],function(t){"use strict";var e;return{setters:[],execute:function(){e=function(){var t=function(t){this.position={},this.setPosition(t.position),this.setType("m"),this.modes={0:"normal"},this.mode=0};return $traceurRuntime.createClass(t,{setPosition:function(t){this.position.x=t.x,this.position.y=t.y},setType:function(t){this.type=t},move:function(){var t=Math.random(),e=0,i=0;.25>t?e=-1:.5>t?e=1:i=.75>t?-1:1;this.position.x,this.position.y;this.position.x+=e,this.position.y+=i},setMode:function(t){this.mode=t}},{})}(),t("default",e)}}}),t.register("classes/mobs/rat",["classes/mob"],function(t){"use strict";var e,i;return{setters:[function(t){e=t["default"]}],execute:function(){i=function(t){var e=function i(t){$traceurRuntime.superConstructor(i).call(this,t),this.setType("r")};return $traceurRuntime.createClass(e,{},{},t)}(e),t("default",i)}}}),t.register("lib/render",[],function(t){"use strict";var e;return{setters:[],execute:function(){e=function(){var t=function(){this.el=document.querySelector(".js-game")};return $traceurRuntime.createClass(t,{getLeftCornerOfViewport:function(t,e){var i=t.getKeyForCoords(e.position.x,e.position.y);return i},draw:function(t,e){var i,r,n,s;i={x:e.position.x-e.half.width,y:e.position.y-e.half.height},r={x:e.position.x+e.half.width,y:e.position.y+e.half.height},s=[];for(var o=0,a=t.mobs.length;a>o;o++){var u=t.mobs[o];u.position.x>=i.x&&u.position.x<=r.x&&u.position.y>=i.y&&u.position.y<=r.y&&s.push(u)}n="";for(var h=i.y,d=r.y;d>h;h++){for(var c=i.x,f=r.x;f>c;c++){for(var l=t.getKeyForCoords(c,h),p=!1,m=0,v=s.length;v>m;m++)s[m].position.x===c&&s[m].position.y===h&&(p=s[m]);n+=p?"<span>"+p.type+"</span>":"<span>"+t.map[l]+"</span>"}n+="<br/>"}this.el.innerHTML=n}},{})}(),t("default",new e)}}}),t.register("lib/camera",[],function(t){"use strict";var e;return{setters:[],execute:function(){e=function(){var t=function(){this.position={x:0,y:0},this.setViewportSize({width:20,height:20}),this.viewport={width:20,height:20},this.half={width:Math.floor(.5*this.viewport.width),height:Math.floor(.5*this.viewport.height)}};return $traceurRuntime.createClass(t,{setViewportSize:function(t){this.viewport=t,this.half={width:Math.floor(.5*this.viewport.width),height:Math.floor(.5*this.viewport.height)}},setViewportBounds:function(t){this.minPosition={x:this.half.width,y:this.half.height},this.maxPosition={x:t.width-this.half.width,y:t.height-this.half.height}},setPosition:function(t){this.position.x=t.x<this.minPosition.x?this.minPosition.x:t.x>this.maxPosition.x?this.maxPosition.x:t.x,this.position.y=t.y<this.minPosition.y?this.minPosition.y:t.y>this.maxPosition.y?this.maxPosition.y:t.y},move:function(t){this.setPosition({x:this.position.x+t.x,y:this.position.y+t.y})}},{})}(),t("default",new e)}}}),t.register("lib/io",[],function(t){"use strict";var e;return{setters:[],execute:function(){e=function(){var t=function(){this.bindKeyboard(),this.activeKeys=[]};return $traceurRuntime.createClass(t,{bindKeyboard:function(){var t=this;window.addEventListener("keydown",function(e){t.keyPressed(e)},!1),window.addEventListener("keyup",function(e){t.keyReleased(e)},!1)},keyPressed:function(t){-1===this.activeKeys.indexOf(t.keyCode)&&this.activeKeys.push(t.keyCode)},keyReleased:function(t){var e=this.activeKeys.indexOf(t.keyCode);-1!==e&&this.activeKeys.splice(e,1)},getDirection:function(){var t=-1!==this.activeKeys.indexOf(37)?-1:0,e=-1!==this.activeKeys.indexOf(39)?1:0,i=-1!==this.activeKeys.indexOf(38)?-1:0,r=-1!==this.activeKeys.indexOf(40)?1:0;return{x:t+e,y:i+r}}},{})}(),t("default",new e)}}}),t.register("lib/loop",[],function(t){"use strict";var e;return{setters:[],execute:function(){e=function(){var t=function(){this.fps=1e3/60};return $traceurRuntime.createClass(t,{start:function(){this.startTime=(new Date).getTime(),this.timeSinceLastUpdate=0,this.tick(0)},tick:function(t){var e=(new Date).getTime()-this.startTime,i=t-e;this.timeSinceLastUpdate+=i,this.timeSinceLastUpdate>this.fps&&(this.update(),this.timeSinceLastUpdate=0),this.draw(),window.requestAnimationFrame(this.tick.bind(this))},update:function(){},draw:function(){}},{})}(),t("default",new e)}}}),t.register("classes/mobs/spider",["classes/mob"],function(t){"use strict";var e,i;return{setters:[function(t){e=t["default"]}],execute:function(){i=function(t){var e=function i(t){$traceurRuntime.superConstructor(i).call(this,t),this.setType("s")};return $traceurRuntime.createClass(e,{},{},t)}(e),t("default",i)}}}),t.register("lib/mobs",["classes/mobs/spider","classes/mobs/rat"],function(t){"use strict";var e,i,r;return{setters:[function(t){e=t["default"]},function(t){i=t["default"]}],execute:function(){r=function(){var t=function(){this.mobs={spider:e,rat:i}};return $traceurRuntime.createClass(t,{getNumberOfMobs:function(){var t=0;for(var e in this.mobs)this.mobs.hasOwnProperty(e)&&t++;return t},getRandomMob:function(){var t=Math.floor(this.getNumberOfMobs()*Math.random()),e=0;for(var i in this.mobs)if(this.mobs.hasOwnProperty(i)){if(e===t)return this.mobs[i];e++}return!1}},{})}(),t("default",new r)}}}),t.register("lib/level",["lib/mobs"],function(t){"use strict";var e,i;return{setters:[function(t){e=t["default"]}],execute:function(){i=function(){var t=function(){this.CAVERN_SIZE=50*Math.random()+200,this.MINORS=50*Math.random()+100,this.MOBS=100};return $traceurRuntime.createClass(t,{init:function(t,e){this.width=t,this.height=e,this.map=[],this.generateMap(),this.createMobs(),this.createStartPoint(),this.createEndPoint()},getCoordsForKey:function(t){if(0===t)return[0,0];var e=Math.floor(t/this.width),i=t%this.width;return[i,e]},getKeyForCoords:function(t,e){return e*this.width+t},isKeyValid:function(t){return t>0&&t<=this.map.length},isCoordsValid:function(t,e){return t>=0&&t<this.width&&e>=0&&e<this.height},generateMap:function(){for(var t=0,e=this.width*this.height;e>t;t++)this.map[t]="X";for(var i=0,r=this.MINORS;r>i;i++)this.mineMap(Math.floor(Math.random()*this.map.length));for(var n=0,s=this.width;s>n;n++){this.map[n]="-";var o=this.getKeyForCoords(n,this.height-1);this.map[o]="-"}for(var a=0,u=this.height;u>a;a++){var h=this.getKeyForCoords(0,a);this.map[h]="|",h=this.getKeyForCoords(this.width-1,a),this.map[h]="|"}this.map[0]="+",this.map[this.width-1]="+",this.map[this.width*this.height-1]="+",this.map[this.width*this.height-this.width]="+"},mineMap:function(t){for(var e=this.getCoordsForKey(t),i=Math.random()>.3,r=0,n=this.CAVERN_SIZE;n>r;r++){var s=Math.random();this.minePoint(e[0],e[1],i),.25>s?e[0]+=1:.5>s?e[0]-=1:.75>s?e[1]+=1:e[1]-=1}},minePoint:function(t,e,i){this.isCoordsValid(t,e)&&(this.map[this.getKeyForCoords(t,e)]="."),i&&(this.isCoordsValid(t-1,e)&&(this.map[this.getKeyForCoords(t-1,e)]="."),this.isCoordsValid(t+1,e)&&(this.map[this.getKeyForCoords(t+1,e)]="."),this.isCoordsValid(t,e-1)&&(this.map[this.getKeyForCoords(t,e-1)]="."),this.isCoordsValid(t,e+1)&&(this.map[this.getKeyForCoords(t,e+1)]="."))},getFreePosition:function(){var t,e;do t=Math.floor(Math.random()*this.map.length);while("."!==this.map[t]);return e=this.getCoordsForKey(t),{x:e[0],y:e[1]}},createMobs:function(){this.mobs=[];for(var t=0,i=this.MOBS;i>t;t++){var r=this.getFreePosition(),n=e.getRandomMob(),s=new n({position:r});this.mobs.push(s)}},createStartPoint:function(){},createEndPoint:function(){}},{})}(),t("default",new i)}}}),t.register("lib/game",["lib/level","lib/render","lib/camera","lib/io","lib/loop"],function(t){"use strict";var e,i,r,n,s,o;return{setters:[function(t){e=t["default"]},function(t){i=t["default"]},function(t){r=t["default"]},function(t){n=t["default"]},function(t){s=t["default"]}],execute:function(){o=function(){var t=function(){this.width=200,this.height=200,e.init(this.width,this.height),r.setViewportSize({width:40,height:30}),r.setViewportBounds(e),r.setPosition({x:.5*this.width,y:.5*this.height}),s.update=function(){r.move(n.getDirection());for(var t=0,i=e.mobs.length;i>t;t++)e.mobs[t].move()},s.draw=function(){i.draw(e,r)},s.start()};return $traceurRuntime.createClass(t,{},{})}(),t("default",new o)}}}),t.register("lib/main",["lib/game"],function(t){"use strict";var e;return{setters:[function(t){e=t["default"]}],execute:function(){t("default",{})}}})});
//# sourceMappingURL=build.js.map